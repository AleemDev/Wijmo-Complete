/*
 *
 * Wijmo Library 0.8.0
 * http://wijmo.com/
 *
 * Copyright(c) ComponentOne, LLC.  All rights reserved.
 * 
 * Dual licensed under the Wijmo Commercial or GNU GPL Version 3 licenses.
 * licensing@wijmo.com
 * http://wijmo.com/license
 *
 *
 **/
(function(a){a.widget("ui.wijpager",{options:{firstPageClass:"ui-icon-seek-first",firstPageText:"First",lastPageClass:"ui-icon-seek-end",lastPageText:"Last",mode:"numeric",nextPageClass:"ui-icon-seek-next",nextPageText:"Next",pageButtonCount:10,previousPageClass:"ui-icon-seek-prev",previousPageText:"Previous",pageCount:1,pageIndex:0,pageindexchanging:null,pageindexchanged:null},_create:function(){this.element.addClass("ui-widget ui-wijpager ui-helper-clearfix");this.options.disabled&&this.disable();this._refresh()},_init:function(){__wijReadOptionEvents(["pageindexchanging","pageindexchanged"],this)},destroy:function(){this.element.removeClass("ui-widget ui-wijpager ui-helper-clearfix");this.$ul.remove();a.Widget.prototype.destroy.apply(this,arguments)},_setOption:function(){a.Widget.prototype._setOption.apply(this,arguments);this._refresh()},_refresh:function(){this._validate();this.$ul&&this.$ul.remove();this.element.append(this.$ul=a('<ul class="ui-list ui-corner-all ui-widget-content ui-helper-clearfix"></ul>'));switch(this.options.mode){case"nextPrevious":this._createNextPrev(false);break;case"nextPreviousFirstLast":this._createNextPrev(true);break;case"numeric":this._createNumeric(false);break;case"numericFirstLast":this._createNumeric(true)}},_validate:function(){if(isNaN(this.options.pageCount)||this.options.pageCount<1)this.options.pageCount=1;if(isNaN(this.options.pageIndex)||this.options.pageIndex<0)this.options.pageIndex=0;else if(this.options.pageIndex>=this.options.pageCount)this.options.pageIndex=this.options.pageCount-1;if(isNaN(this.options.pageButtonCount)||this.options.pageButtonCount<1)this.options.pageButtonCount=1},_createNextPrev:function(a){a&&this.options.pageIndex&&this.$ul.append(this._createPagerItem().append(this._createPagerControl(1,this.options.firstPageText,this.options.firstPageClass)));this.options.pageIndex&&this.$ul.append(this._createPagerItem().append(this._createPagerControl(this.options.pageIndex,this.options.previousPageText,this.options.previousPageClass)));this.options.pageIndex+1<this.options.pageCount&&this.$ul.append(this._createPagerItem().append(this._createPagerControl(this.options.pageIndex+2,this.options.nextPageText,this.options.nextPageClass)));a&&this.options.pageIndex+1<this.options.pageCount&&this.$ul.append(this._createPagerItem().append(this._createPagerControl(this.options.pageCount,this.options.lastPageText,this.options.lastPageClass)))},_createNumeric:function(d){var e=this.options.pageIndex+1,b=1,a=Math.min(this.options.pageCount,this.options.pageButtonCount);if(e>a){b=Math.floor(this.options.pageIndex/this.options.pageButtonCount)*this.options.pageButtonCount+1;a=b+this.options.pageButtonCount-1;a=Math.min(a,this.options.pageCount);if(a-b+1<this.options.pageButtonCount)b=Math.max(1,a-this.options.pageButtonCount+1)}if(b!=1){d&&this.$ul.append(this._createPagerItem().append(this._createPagerControl(1,this.options.firstPageText,this.options.firstPageClass)));this.$ul.append(this._createPagerItem().append(this._createPagerControl(b-1,"...","")))}for(var c=b;c<=a;c++){var f=c===e;this.$ul.append(this._createPagerItem(f).append(this._createPagerControl(c,c.toString(),"",f)))}if(this.options.pageCount>a){this.$ul.append(this._createPagerItem().append(this._createPagerControl(a+1,"...","")));d&&this.$ul.append(this._createPagerItem().append(this._createPagerControl(this.options.pageCount,this.options.lastPageText,this.options.lastPageClass)))}},_createPagerItem:function(c){var b=a("<li />").addClass("ui-page ui-corner-all");if(c)b.addClass("ui-state-active");else b.addClass("ui-state-default").hover(function(){a(this).removeClass("ui-state-default").addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover").addClass("ui-state-default")});return b},_createPagerControl:function(f,e,c,d){var b=null;if(d)b=a("<span />");else if(c)b=a("<span />").addClass("ui-icon "+c);else b=a("<a/>").attr("href","#");b.attr("title",e).text(e);!d&&b.bind("click."+this.widgetName,{newPageIndex:f-1},a.proxy(this._onClick,this));return b},_onClick:function(b){if(this.options.disabled)return false;var a={newPageIndex:b.data.newPageIndex,handled:false};if(this._trigger("pageindexchanging",null,a))if(this.options.pageIndex!==a.newPageIndex){this.options.pageIndex=a.newPageIndex;!a.handled&&this._refresh();this._trigger("pageindexchanged",null,{newPageIndex:a.newPageIndex})}return false}})})($);